/*! emomoBms 2017-02-10 */
window.Onpage_Help=function(a){function b(){if(u){c(),m=document.body.scrollHeight-2,n=document.body.scrollWidth-2;for(var a in p)p.hasOwnProperty(a)&&d(a);for(var a in p)p.hasOwnProperty(a)&&e(a)}}function c(a){if(a===!0||0==s){a===!0&&y.find(".onpage-help-section").remove(),p={},q={},s=0;var b=k("*").contents().filter(function(){return 8==this.nodeType});k(b).each(function(){var a;if(a=k.trim(this.data).match(/#section\s*:\s*([\w\d\-\.\/]+)/i)){var b=a[1];b in p||(p[b]=this)}if(a=k.trim(this.data).match(/\/section\s*:\s*([\w\d\-\.\/]+)/i)){var b=a[1];!(b in q)&&b in p&&(q[b]=this,s++)}})}}function d(a){if(a in p&&a in q){for(var b=1e6,c=1e6,d=-1e6,e=-1e6,f=!1,g=[],h=p[a],i=q[a];h!=i&&(h=h.nextSibling,null!=h);)1==h.nodeType&&g.push(h);var j=g.length;if(j>0&&!w.settings.include_all&&(g=1==j?[g[0]]:[g[0],g[j-1]]),k(g).each(function(){var a=k(this);if(!a.is(":hidden")){var g=a.offset(),h=a.outerWidth(),i=a.outerHeight();g&&h&&i&&(f=!0,g.left<b&&(b=g.left),g.left+h>d&&(d=g.left+h),g.top<c&&(c=g.top),g.top+i>e&&(e=g.top+i))}}),!f)return void(r[a]={is_hidden:!0});b-=1,c-=1,d+=1,e+=1;var l=d-b,o=e-c;return b+l<2||b>n||c+o<2||c>m?void(r[a]={is_hidden:!0}):void(r[a]={left:parseInt(b),top:parseInt(c),width:parseInt(l),height:parseInt(o)})}}function e(a){if(a in r&&y){var b=y.find('.onpage-help-section[data-section="'+a+'"]').eq(0);0==b.length&&(b=k('<a class="onpage-help-section" href="#" />').appendTo(y),o&&b.append('<span class="ie-hover-fix" />'),w.settings.icon_1&&b.append('<i class="help-icon-1 '+w.settings.icon_1+'"></i>'),w.settings.icon_2&&b.append('<i class="help-icon-2 '+w.settings.icon_2+'"></i>'),b.attr("data-section",a),b.on("click",function(b){b.preventDefault(),h(a)}));var c=r[a];if(c.is_hidden===!0)return void b.addClass("hidden");b.css({left:c.left,top:c.top,width:c.width,height:c.height}),b.removeClass("hidden"),b.removeClass("help-section-small help-section-smaller"),c.height<55||c.width<55?b.addClass("help-section-smaller"):(c.height<75||c.width<75)&&b.addClass("help-section-small")}}function f(){if(D){var a=D[0],b=a.scrollHeight<=a.clientHeight;D.parent().off("mousewheel.help DOMMouseScroll.help").on("mousewheel.help DOMMouseScroll.help",function(c){if(b)c.preventDefault();else{var d=c.originalEvent.detail<0||c.originalEvent.wheelDelta>0?1:-1;d==-1&&a.scrollTop+a.clientHeight>=a.scrollHeight?c.preventDefault():1==d&&a.scrollTop<=0&&c.preventDefault()}})}}function g(){if(D){var a=parseInt(F.find(".modal-dialog").css("margin-top"));a=a+110+parseInt(a/2),E=parseInt(k(window).innerHeight()-a+40),D.css({"max-height":E})}}function h(a,b){null==F&&(F=k('<div id="onpage-help-modal" class="modal onpage-help-modal" tabindex="-1" role="dialog" aria-labelledby="HelpModalDialog" aria-hidden="true">\t\t\t  <div class="modal-dialog modal-lg">\t\t\t\t<div class="modal-content">\t\t\t\t\t<div class="modal-header">\t\t\t\t\t  <div class="pull-right onpage-help-modal-buttons">\t\t\t\t\t\t<button aria-hidden="true" data-navdir="up" type="button" class="disabled btn btn-white btn-success btn-sm"><i class="ace-icon fa fa-level-up fa-flip-horizontal bigger-125 icon-only"></i></button>\t\t\t\t\t\t&nbsp;\t\t\t\t\t\t<button aria-hidden="true" data-navdir="back" type="button" class="disabled btn btn-white btn-info btn-sm"><i class="ace-icon fa fa-arrow-left icon-only"></i></button>\t\t\t\t\t\t<button aria-hidden="true" data-navdir="forward" type="button" class="disabled btn btn-white btn-info  btn-sm"><i class="ace-icon fa fa-arrow-right icon-only"></i></button>\t\t\t\t\t\t&nbsp;\t\t\t\t\t\t<button aria-hidden="true" data-dismiss="modal" class="btn btn-white btn-danger btn-sm" type="button"><i class="ace-icon fa fa-times icon-only"></i></button>\t\t\t\t\t  </div>\t\t\t\t\t  <h4 class="modal-title">Help Dialog</h4>\t\t\t\t\t</div>\t\t\t\t\t<div class="modal-body"><div class="onpage-help-content"></div></div>\t\t\t\t</div>\t\t\t  </div>\t\t\t</div>').appendTo("body"),D=F.find(".modal-body"),D.css({"overflow-y":"auto","overflow-x":"hidden"}),F.css({overflow:"hidden"}).on("show.bs.modal",function(){A()}).on("hidden.bs.modal",function(){z()}),F.find(".onpage-help-modal-buttons").on("click","button[data-navdir]",function(){var a=k(this).attr("data-navdir");if("back"==a)C>0&&(C--,h(B[C],!1));else if("forward"==a)C<B.length-1&&(C++,h(B[C],!1));else if("up"==a){var b,c=k(this);if(c.hasClass("disabled")||!(b=c.attr("data-url")))return;h(b,!0)}})),F.hasClass("in")||(document.body.lastChild!=F[0]&&k(document.body).append(F),F.modal("show"),g()),F.find(".modal-title").wrapInner("<span class='hidden' />").append('<i class="fa fa-spinner fa-spin blue bigger-125"></i>');var c=k(".onpage-help-content");c.addClass("hidden"),k(document.body).removeClass("modal-open");var d=a.match(/file\:(.*?)\:(.+)/i);return d&&3==d.length?void j(d[2],d[1],!1):(a=a.replace(/^#/g,""),"function"==typeof w.settings.section_url&&(url=w.settings.section_url.call(v,a)),void k.ajax({url:url,dataType:"text"}).done(function(d){var e="",g="";if("function"==typeof w.settings.section_title)e=w.settings.section_title.call(v,d,a,url);else for(var h=function(a){return a.replace(/[\-\.\(\)\=\"\'\\\/]/g,function(a,b){return"\\"+a})},j=a;0==e.length;){var l='\\<([a-z][a-z0-9]*)(?:\\s+)(?:[^\\<\\>]+?)data\\-id\\=\\"\\#'+h(j)+'\\"(?:[^\\>]*)\\>([\\s\\S]*?)</\\1>',m=(new RegExp(l,"im"),d.match(l));if(m&&m[2]){e=m[2];break}var n;if(!((n=j.lastIndexOf("."))>-1))break;j=j.substr(0,n)}if(F.find(".modal-title").html(k.trim(e)||"&nbsp;"),"function"==typeof w.settings.section_content)g=w.settings.section_content.call(v,d,a,url);else{var o="<!-- #section:"+a+" -->",p=d.indexOf(o),q=d.indexOf("<!-- /section:"+a+" -->",p);if(p==-1||q==-1)return void F.find(".modal-title").html("&nbsp;");g=d.substring(p+o.length+1,q)}if(g="function"==typeof w.settings.code_highlight?w.settings.code_highlight.call(v,g):g.replace(/\<pre((?:(?:.*?)(?:data\-language=["'](?:[\w\d]+)["'])(?:.*?))|(?:(?:.*?)(?:class=["'](?:.*?)language\-(?:[\w\d]+)(?:.*?)["'])(?:.*?)))\>([\s\S]+?)\<\/pre\>/gi,function(a,b,c){return"<pre"+b+">"+c.replace(/\</g,"&lt;").replace(/\>/g,"&gt;")+"</pre>"}),"function"==typeof w.settings.img_url&&(g=g.replace(/\<img(?:(?:.*?)src=["']([^"']+)["'])/gi,function(a,b){var c=w.settings.img_url.call(v,b);return a.replace(b,c)})),c.empty().append(g),"function"==typeof w.settings.code_highlight)w.settings.code_highlight.call(v,c);else if("rainbow"===w.settings.code_highlight)try{Rainbow.color(c[0])}catch(a){}else if("prism"===w.settings.code_highlight)try{c.find('pre[class*="language-"],code[class*="language-"]').each(function(){Prism.highlightElement(this)})}catch(a){}if(w.settings.add_panels){c.find(w.settings.panel_content_selector).each(function(){var a=k(this).prevAll(w.settings.panel_content_title);return 0!=a.length&&(a=a.attr("class","panel-title").wrapInner('<a class="help-panel-toggle" href="#" data-parent="#" data-toggle="collapse" />').wrap('<div class="panel-heading" />').closest(".panel-heading"),k(this).wrap('<div class="panel panel-default panel-help"><div class="panel-collapse collapse"><div class="panel-body"></div></div></div>'),void k(this).closest(".panel").prepend(a))});var r=k(".panel-group").length;c.find(".panel").each(function(){if(!k(this).parent().hasClass("panel-group")){var a="panel-group-help-"+ ++r,b=k('<div class="panel-group" />').insertBefore(this);b.attr("id",a);var c=0;b.siblings(".panel").appendTo(b),b.find(".help-panel-toggle").append('<i class="pull-right ace-icon fa fa-plus" data-icon-show="ace-icon fa fa-plus" data-icon-hide="ace-icon fa fa-minus"></i>').attr("data-parent","#"+a).each(function(){c++,k(this).attr("data-target","#"+a+"-"+c),k(this).closest(".panel-heading").siblings(".panel-collapse").attr("id",a+"-"+c)})}}),k(document).off("click.help-panel-toggle",".help-panel-toggle").on("click.help-panel-toggle",".help-panel-toggle",function(a){a.preventDefault()})}c.removeClass("hidden");var s=c.find("img:visible");if(s.length>0){var t=0;s.off(".help_body_scroll").on("load.help_body_scroll error.help_body_scroll",function(){k(this).off(".help_body_scroll"),t++,t>=s.length&&f()})}f(),c.find(".panel > .panel-collapse").on("shown.bs.collapse hidden.bs.collapse",function(){f()}),i(a,b);var u=-1;(u=a.lastIndexOf("."))>-1?(a=a.substr(0,u),F.find("button[data-navdir=up]").removeClass("disabled").attr("data-url",a)):F.find("button[data-navdir=up]").addClass("disabled").removeAttr("data-url").blur()}).fail(function(){F.find(".modal-title").find(".fa-spin").remove().end().find(".hidden").children().unwrap()}))}function i(a,b){b!==!1&&(B.length>0&&(B=B.slice(0,C+1)),B[B.length-1]!=a&&(B.push(a),C=B.length-1)),0==C?F.find("button[data-navdir=back]").addClass("disabled").blur():F.find("button[data-navdir=back]").removeClass("disabled"),C==B.length-1?F.find("button[data-navdir=forward]").addClass("disabled").blur():F.find("button[data-navdir=forward]").removeClass("disabled")}function j(a,b,c){var d=a;"function"==typeof w.settings.file_url&&(a=w.settings.file_url.call(v,a,b)),k.ajax({url:a,dataType:"text"}).done(function(a){i("file:"+b+":"+d,c),F.find("button[data-navdir=up]").addClass("disabled").blur(),F.find(".modal-title").html(d).wrapInner("<code />"),"json"!=b?a="css"!=b?a.replace(/\n[\t]{1,}/g,function(a,b){return a.replace(/\t/g,"  ")}):a.replace(/\t/g,"  "):(b="javascript",a=JSON.stringify(JSON.parse(a),null,2)),a=a.replace(/\>/g,"&gt;").replace(/\</g,"&lt;");var e=k(".onpage-help-content");if(e.removeClass("hidden").empty(),"function"==typeof w.settings.code_highlight)a=w.settings.code_highlight.call(v,a,b),e.html(a);else if("rainbow"===w.settings.code_highlight)try{Rainbow.color(a,b,function(a){e.html(a).wrapInner('<pre data-language="'+b+'" />')})}catch(a){}else if("prism"===w.settings.code_highlight)try{a=Prism.highlight(a,Prism.languages[b],b),e.html(a).wrapInner('<pre class="language-'+b+'" />')}catch(a){}})}var k=window.jQuery||null;if(null!=k){a=a||{};var l={include_all:!0,icon_1:"fa fa-question",icon_2:"fa fa-lightbulb-o",base:"",code_highlight:window.Rainbow?"rainbow":window.Prism?"prism":null,add_panels:!0,panel_content_selector:".info-section",panel_content_title:".info-title"};this.settings=k.extend({},l,a);var m,n,o=(this.settings.base,document.all&&!window.atob),p={},q={},r={},s=0,t=!1,u=!1,v=this,w=this,x="",y=null,z=function(){if(y){var a=-1;k(document).off("focusin.ace.help").on("focusin.ace.help",function(b){y[0]==b.target||k.contains(y[0],b.target)||y.focus(),b.target==document&&a>-1&&(k("body,html").scrollTop(a),a=-1)}),k(window).on("blur.ace.help",function(){a=k(window).scrollTop()})}},A=function(){k(document).off("focusin.ace.help"),k(window).off("blur.ace.help")};this.toggle=function(){u?v.disable():v.enable()},this.enable=function(){u||"function"==typeof w.settings.before_enable&&w.settings.before_enable.call(v)===!1||(u=!0,k(".onpage-help-backdrop, .onpage-help-section").removeClass("hidden"),x=document.body.style.overflowX,document.body.style.overflowX="hidden",b(),z(),"function"==typeof w.settings.after_enable&&w.settings.after_enable.call(v))},this.disable=function(){u&&("function"==typeof w.settings.before_disable&&w.settings.before_disable.call(v)||(u=!1,k(".onpage-help-backdrop, .onpage-help-section").addClass("hidden"),document.body.style.overflowX=x,A(),"function"==typeof w.settings.after_disable&&w.settings.after_disable.call(v)))},this.is_active=function(){return u},this.show_section_help=function(a){h(a,!0)},this.init=function(){t||(y=k('<div class="onpage-help-container" id="onpage-help-container" tabindex="-1" />').appendTo("body"),y.append('<div class="onpage-help-backdrop hidden" />'),k(window).on("resize.onpage_help",function(){u&&(b(),null!=F&&F.hasClass("in")&&(g(),f()))}),t=!0)},this.init(),this.update_sections=function(){c(!0)};var B=[],C=-1,D=null,E=0,F=null;k(document).on("click",'.onpage-help-modal a[href^="http"]',function(){k(this).attr("target","_blank")}),k(document).on("click",".help-more",function(a){a.preventDefault();var b=k(this).attr("href");h(b)}),k(document).on("click",".open-file[data-open-file]",function(){F.find(".modal-title").wrapInner("<span class='hidden' />").append('<i class="fa fa-spinner fa-spin blue bigger-125"></i>'),k(".onpage-help-content").addClass("hidden");var a=k(this).attr("data-path")||k(this).text(),b=k(this).attr("data-open-file");j(a,b,!0)})}};